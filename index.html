<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<<<<<<< HEAD
    <title>ì•„ì´ë””ì–´ ì‹œê°í™” íŒŒíŠ¸ë„ˆ (Gemini + Mermaid)</title>
    <!-- Tailwind CSS ë¡œë”© -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter í°íŠ¸ ì„¤ì • -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .mermaid-container {
            border: 2px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 1rem;
            background-color: #ffffff;
            /* Mermaid ë Œë”ë§ ì˜ì—­ ë†’ì´ í™•ë³´ */
            min-height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: auto; /* ë‹¤ì´ì–´ê·¸ë¨ì´ ì»¤ì§ˆ ê²½ìš° ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ê²Œ */
        }
        /* Mermaid ê¸°ë³¸ ì„¤ì •ì„ ìœ„í•œ ìŠ¤íƒ€ì¼ (í•„ìˆ˜) */
        .mermaid {
            width: 100%;
            height: 100%;
        }
    </style>
    <!-- Mermaid JS ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">

    <div class="max-w-4xl mx-auto p-6 md:p-10">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-extrabold text-gray-900 mb-2">
                ì•„ì´ë””ì–´ ì‹œê°í™” íŒŒíŠ¸ë„ˆ ğŸ¤–
            </h1>
            <p class="text-lg text-gray-600">
                í”„ë¡œì íŠ¸ êµ¬ìƒì„ í•œêµ­ì–´ë¡œ ì„¤ëª…í•´ ì£¼ì‹œë©´, Geminiê°€ Mermaid ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ êµ¬ì¡°ë¥¼ ê·¸ë ¤ë“œë¦½ë‹ˆë‹¤.
            </p>
        </header>

        <!-- ì…ë ¥ ì˜ì—­ -->
        <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 mb-8">
            <label for="promptInput" class="block text-lg font-semibold text-gray-700 mb-3">í”„ë¡œì íŠ¸ êµ¬ìƒ ì„¤ëª… (í•œêµ­ì–´)</label>
            <textarea id="promptInput" rows="6" class="w-full p-4 border border-gray-300 rounded-lg resize-none focus:ring-blue-500 focus:border-blue-500 text-base" placeholder="ì˜ˆ: 'ì˜¨ë¼ì¸ ë°˜ë ¤ë™ë¬¼ ì»¤ë®¤ë‹ˆí‹° ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ê³  ì‹¶ìŠµë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ê°€ì…í•´ì„œ ìì‹ ì˜ ë°˜ë ¤ë™ë¬¼ ì •ë³´ë¥¼ ë“±ë¡í•˜ê³ , ì‚¬ì§„ì„ ì˜¬ë¦´ ìˆ˜ ìˆìœ¼ë©°, ëŒ“ê¸€ë¡œ ë‹¤ë¥¸ ì‚¬ìš©ìì™€ ì†Œí†µí•  ìˆ˜ ìˆëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.'"></textarea>
            
            <button onclick="processIdea()" id="generateButton" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-150 ease-in-out shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                Mermaid ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±
            </button>
        </div>

        <!-- ê²°ê³¼ ì˜ì—­ -->
        <div id="resultsSection" class="hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">ì‹œê°í™” ê²°ê³¼</h2>
            
            <!-- LLM ì„¤ëª… ì˜ì—­ -->
            <div class="bg-blue-50 p-4 rounded-lg mb-6 border border-blue-200">
                <h3 class="font-semibold text-blue-800 mb-2">ë¶„ì„ ë‚´ìš©</h3>
                <p id="explanationOutput" class="text-gray-700 leading-relaxed"></p>
            </div>

            <!-- Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì˜ì—­ -->
            <h3 class="font-bold text-gray-700 mb-2">í´ë˜ìŠ¤/êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨</h3>
            <div id="mermaidDiagram" class="mermaid-container">
                <pre id="mermaidSyntaxCode" class="text-sm text-gray-500 whitespace-pre-wrap">ì—¬ê¸°ì— Mermaid ë¬¸ë²•ì´ í‘œì‹œë©ë‹ˆë‹¤.</pre>
            </div>
            
            <h3 class="font-bold text-gray-700 mt-6 mb-2">Mermaid ë¬¸ë²• (ë””ë²„ê¹…ìš©)</h3>
            <div class="bg-gray-800 p-4 rounded-lg overflow-x-auto">
                <code id="mermaidSyntaxDisplay" class="text-xs text-green-300 whitespace-pre"></code>
            </div>

        </div>

        <!-- ë¡œë”© ë° ì˜¤ë¥˜ ë©”ì‹œì§€ -->
        <div id="statusMessage" class="text-center p-4 rounded-lg hidden"></div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- Mermaid JS ì´ˆê¸°í™” ---
            mermaid.initialize({
                startOnLoad: false,
                theme: 'default',
                securityLevel: 'loose',
                class: {
                    defaultFill: '#fafafa',
                    defaultStroke: '#6b7280',
                    textFill: '#1f2937'
                }
            });

            // --- Gemini API í˜¸ì¶œ ì„¤ì • ---
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            // LLMì—ê²Œ ì—­í• ê³¼ ì¶œë ¥ í˜•ì‹ì„ ì§€ì •í•˜ëŠ” ì‹œìŠ¤í…œ ëª…ë ¹ì–´
            const systemPrompt = "ë‹¹ì‹ ì€ ì„¸ê³„ì ì¸ ì†Œí”„íŠ¸ì›¨ì–´ ì•„í‚¤í…ì²˜ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì‚¬ìš©ìê°€ ì œê³µí•œ í•œêµ­ì–´ í”„ë¡œì íŠ¸ êµ¬ìƒ ë‚´ìš©ì„ ê°ì²´ì§€í–¥ì  ê´€ì ì—ì„œ ë¶„ì„í•˜ì—¬ í•µì‹¬ í´ë˜ìŠ¤, ì†ì„±, ë©”ì†Œë“œ, ê·¸ë¦¬ê³  ê·¸ ê´€ê³„ë¥¼ ë„ì¶œí•˜ì„¸ìš”. ì‘ë‹µì€ ë°˜ë“œì‹œ ì•„ë˜ ì •ì˜ëœ JSON ìŠ¤í‚¤ë§ˆë¥¼ ë”°ë¥´ë©°, Mermaid Class Diagram ë¬¸ë²•ì„ ì‚¬ìš©í•˜ì—¬ ì‹œê°í™” ê°€ëŠ¥í•œ í…ìŠ¤íŠ¸ë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤. * í´ë˜ìŠ¤ ì†ì„±/ë©”ì†Œë“œ ì•ì—ëŠ” ì ‘ê·¼ ì œí•œì (+ public, - private, # protected)ë¥¼ ëª…ì‹œí•˜ì„¸ìš”. * í´ë˜ìŠ¤ ì´ë¦„ì€ PascalCaseë¥¼ ì‚¬ìš©í•˜ì„¸ìš”. * ê´€ê³„(ìƒì†: --|>, í¬í•¨: --*) ë“±ì„ ëª…ì‹œí•˜ì—¬ ë‹¤ì´ì–´ê·¸ë¨ì„ í’ë¶€í•˜ê²Œ ë§Œë“œì„¸ìš”.";

            // LLMì´ ë°˜í™˜í•´ì•¼ í•  JSON ìŠ¤í‚¤ë§ˆ ì •ì˜
            const responseSchema = {
                type: "OBJECT",
                properties: {
                    "diagramType": { "type": "STRING", "description": "ìƒì„±ëœ ë‹¤ì´ì–´ê·¸ë¨ì˜ ìœ í˜• (Mermaid Class Diagram)" },
                    "mermaidSyntax": { "type": "STRING", "description": "ë Œë”ë§í•  Mermaid Class Diagramì˜ ì „ì²´ ë¬¸ë²• í…ìŠ¤íŠ¸. ë°˜ë“œì‹œ 'classDiagram'ìœ¼ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤." },
                    "explanation_ko": { "type": "STRING", "description": "ìƒì„±ëœ ë‹¤ì´ì–´ê·¸ë¨ì— ëŒ€í•œ ê°„ê²°í•œ í•œêµ­ì–´ ì„¤ëª…." }
                },
                required: ["diagramType", "mermaidSyntax", "explanation_ko"]
            };

            // DOM ìš”ì†Œ ìºì‹œ (Null Check ì´ë¯¸ í¬í•¨)
            const elements = {
                promptInput: document.getElementById('promptInput'),
                resultsSection: document.getElementById('resultsSection'),
                statusMessage: document.getElementById('statusMessage'),
                generateButton: document.getElementById('generateButton'),
                explanationOutput: document.getElementById('explanationOutput'),
                container: document.getElementById('mermaidDiagram'),
                syntaxCode: document.getElementById('mermaidSyntaxCode'),
                syntaxDisplay: document.getElementById('mermaidSyntaxDisplay')
            };

            // í•„ìˆ˜ ìš”ì†Œê°€ í•˜ë‚˜ë¼ë„ ëˆ„ë½ë˜ë©´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¤‘ë‹¨í•©ë‹ˆë‹¤.
            for (const key in elements) {
                if (!elements[key]) {
                    console.error(`CRITICAL ERROR: DOM ìš”ì†Œ '${key}'ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                    elements.statusMessage.innerText = 'í˜ì´ì§€ êµ¬ì¡° ì˜¤ë¥˜: ê²°ê³¼ë¥¼ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì½˜ì†” í™•ì¸ ìš”ë§)';
                    return;
                }
            }


            /**
             * ì§€ìˆ˜ ë°±ì˜¤í”„ë¥¼ í¬í•¨í•˜ì—¬ APIë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜
             */
            async function fetchWithBackoff(url, options, maxRetries = 5) {
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const response = await fetch(url, options);
                        if (response.status === 429 && i < maxRetries - 1) {
                            const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                            console.warn(`API í˜¸ì¶œ ì‹¤íŒ¨ (429). ${delay.toFixed(0)}ms í›„ ì¬ì‹œë„...`);
                            await new Promise(resolve => setTimeout(resolve, delay));
                            continue;
                        }
                        if (!response.ok) {
                            throw new Error(`API í˜¸ì¶œ ì‹¤íŒ¨: ${response.statusText} (${response.status})`);
                        }
                        return response;
                    } catch (error) {
                        if (i === maxRetries - 1) {
                            console.error("ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼:", error);
                            throw error;
                        }
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        console.warn(`API í˜¸ì¶œ ì‹¤íŒ¨: ${error.message}. ${delay.toFixed(0)}ms í›„ ì¬ì‹œë„...`);
                        await new Promise(resolve => setTimeout(resolve, delay));
                    }
                }
                throw new Error("API í˜¸ì¶œì— ì§€ì†ì ìœ¼ë¡œ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            }

            /**
             * LLM ì‘ë‹µ í…ìŠ¤íŠ¸ì—ì„œ ë¶ˆí•„ìš”í•œ ë§ˆí¬ë‹¤ìš´ íƒœê·¸ë¥¼ ì œê±°í•˜ì—¬ ìˆœìˆ˜ JSONë§Œ ì¶”ì¶œí•©ë‹ˆë‹¤. (ì•ˆì •í™” í•µì‹¬)
             */
            function cleanJsonString(text) {
                // 1. ì•ë’¤ ê³µë°± ì œê±°
                text = text.trim();
                // 2. LLMì´ ë¶™ì´ëŠ” ë§ˆí¬ë‹¤ìš´ ì½”ë“œ ë¸”ë¡(```json, ```) ì œê±°
                if (text.startsWith('```json')) {
                    text = text.substring(7); // '```json' ì œê±°
                } else if (text.startsWith('```')) {
                    text = text.substring(3); // '```' ì œê±°
                }
                if (text.endsWith('```')) {
                    text = text.substring(0, text.length - 3); // ëì˜ '```' ì œê±°
                }
                return text.trim();
            }

            /**
             * ì•„ì´ë””ì–´ êµ¬ìƒì„ ì²˜ë¦¬í•˜ê³  ë‹¤ì´ì–´ê·¸ë¨ì„ ìƒì„±í•©ë‹ˆë‹¤.
             */
            window.processIdea = async function() {
                const prompt = elements.promptInput.value.trim();

                if (!prompt) {
                    displayStatus('warning', 'êµ¬ìƒ ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.');
                    return;
                }

                // UI ì´ˆê¸°í™” ë° ë¡œë”© í‘œì‹œ
                elements.resultsSection.classList.add('hidden');
                displayStatus('loading', 'Gemini ì•„í‚¤í…ì²˜ íŒŒíŠ¸ë„ˆê°€ êµ¬ìƒì„ ë¶„ì„í•˜ê³  ë‹¤ì´ì–´ê·¸ë¨ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...');
                elements.generateButton.disabled = true;

                try {
                    const payload = {
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                        generationConfig: {
                            responseMimeType: "application/json",
                            responseSchema: responseSchema
                        }
                    };

                    const options = {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    };

                    const response = await fetchWithBackoff(apiUrl, options);
                    const result = await response.json();

                    const candidate = result.candidates?.[0];

                    if (!candidate || !candidate.content?.parts?.[0]?.text) {
                         throw new Error("APIì—ì„œ ìœ íš¨í•œ ì‘ë‹µì„ ë°›ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. (í›„ë³´ ì—†ìŒ)");
                    }

                    // 1. JSON ë¬¸ìì—´ ì •ì œ í›„ íŒŒì‹± (ê°€ì¥ ì¤‘ìš”í•œ ì•ˆì •í™” ë¶€ë¶„)
                    const rawJsonText = candidate.content.parts[0].text;
                    const cleanText = cleanJsonString(rawJsonText);
                    
                    let parsedJson;
                    try {
                        parsedJson = JSON.parse(cleanText);
                    } catch (e) {
                        console.error("JSON íŒŒì‹± ì‹¤íŒ¨ ì›ë³¸:", rawJsonText);
                        throw new Error(`JSON íŒŒì‹± ì‹¤íŒ¨: LLMì´ ì•½ì†ëœ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. (ì›ë³¸: ${cleanText.substring(0, 100)}...)`);
                    }

                    const { mermaidSyntax, explanation_ko } = parsedJson;
                    
                    // 2. Mermaid ë¬¸ë²• ìœ íš¨ì„± ë° ì¡´ì¬ ì—¬ë¶€ í™•ì¸
                    if (!mermaidSyntax || !mermaidSyntax.trim().toLowerCase().startsWith('classdiagram')) {
                        console.error("Mermaid ë¬¸ë²• ëˆ„ë½/í˜•ì‹ ì˜¤ë¥˜:", mermaidSyntax);
                        throw new Error("Mermaid ë¬¸ë²•ì´ ìƒì„±ë˜ì—ˆìœ¼ë‚˜ 'classDiagram'ìœ¼ë¡œ ì‹œì‘í•˜ì§€ ì•Šê±°ë‚˜ ë¹„ì–´ìˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
                    }

                    let finalMermaidSyntax = mermaidSyntax.trim();
                    
                    // ** FIX: 'classDiagram' í‚¤ì›Œë“œ ë’¤ì— ê³µë°±ì´ ì—†ëŠ” ê²½ìš° ê°•ì œë¡œ ì¤„ ë°”ê¿ˆ ì‚½ì… **
                    const keyword = 'classDiagram';
                    const lowerSyntax = finalMermaidSyntax.toLowerCase();
                    if (lowerSyntax.startsWith(keyword) && lowerSyntax.length > keyword.length) {
                        // 'classDiagram' ë‹¤ìŒ ë¬¸ìê°€ ê³µë°±ì´ë‚˜ ì¤„ë°”ê¿ˆì´ ì•„ë‹Œì§€ í™•ì¸
                        const nextChar = finalMermaidSyntax[keyword.length];
                        if (nextChar && !/\s/.test(nextChar)) {
                            // ë¬¸ë²•ì„ 'classDiagram\n...' í˜•íƒœë¡œ ìˆ˜ì •
                            finalMermaidSyntax = keyword + '\n' + finalMermaidSyntax.substring(keyword.length);
                        }
                    }

                    // 3. UI ì—…ë°ì´íŠ¸
                    elements.explanationOutput.innerText = explanation_ko;

                    // 4. Mermaid ë‹¤ì´ì–´ê·¸ë¨ ë Œë”ë§
                    
                    // ì´ì „ ê²°ê³¼ ë° ë””ë²„ê¹… ì½”ë“œ ì œê±°
                    elements.container.innerHTML = ''; 
                    elements.syntaxDisplay.innerText = finalMermaidSyntax; // ìˆ˜ì •ëœ ë¬¸ë²• í‘œì‹œ
                    
                    // Mermaid ë Œë”ë§ì„ ìœ„í•œ ì„ì‹œ div ìƒì„±
                    const graphDiv = document.createElement('div');
                    graphDiv.className = 'mermaid';
                    elements.container.appendChild(graphDiv);

                    // Mermaid ë Œë”ë§
                    const renderId = 'diagram-' + Date.now();
                    try {
                        // ìˆ˜ì •ëœ ë¬¸ë²•ì„ ë Œë”ë§ì— ì‚¬ìš©
                        const { svg } = await mermaid.render(renderId, finalMermaidSyntax); 
                        graphDiv.innerHTML = svg;
                    } catch (renderError) {
                        elements.container.innerHTML = `<p class="text-red-500 font-semibold">Mermaid ë Œë”ë§ ì‹¤íŒ¨: ìƒì„±ëœ ë¬¸ë²•ì— ì˜¤ë¥˜ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬¸ë²•ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.</p>`;
                        console.error("Mermaid ë Œë”ë§ ì˜¤ë¥˜:", renderError);
                        displayStatus('error', 'ë‹¤ì´ì–´ê·¸ë¨ ë Œë”ë§ ì‹¤íŒ¨. (ë¬¸ë²• ì˜¤ë¥˜ ê°€ëŠ¥ì„±)');
                        elements.resultsSection.classList.remove('hidden');
                        return; // ë Œë”ë§ ì‹¤íŒ¨ ì‹œ ì´í›„ ì½”ë“œëŠ” ì‹¤í–‰í•˜ì§€ ì•ŠìŒ
                    }
                    
                    // ìµœì¢… ê²°ê³¼ í‘œì‹œ
                    elements.resultsSection.classList.remove('hidden');
                    displayStatus('success', 'ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
                    
                } catch (error) {
                    console.error("í”„ë¡œì„¸ìŠ¤ ì˜¤ë¥˜:", error);
                    displayStatus('error', `ì˜¤ë¥˜ ë°œìƒ: ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (${error.message})`);
                    // ì˜¤ë¥˜ ì‹œì—ë„ UIë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
                    elements.container.innerHTML = `<p class="text-red-500">ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì—¬ ë‹¤ì´ì–´ê·¸ë¨ì„ í‘œì‹œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
                    elements.explanationOutput.innerText = 'ì˜¤ë¥˜ë¡œ ì¸í•´ ì„¤ëª…ì„ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    elements.syntaxDisplay.innerText = error.message;
                    elements.resultsSection.classList.remove('hidden');

                } finally {
                    elements.generateButton.disabled = false;
                }
            }


            /**
             * ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ ìœ í‹¸ë¦¬í‹°
             */
            function displayStatus(type, message) {
                const statusMessage = elements.statusMessage;
                statusMessage.classList.remove('hidden', 'bg-red-100', 'bg-blue-100', 'bg-green-100', 'text-red-700', 'text-blue-700', 'text-green-700', 'bg-yellow-100', 'text-yellow-700');
                statusMessage.innerText = message;
                statusMessage.classList.add('p-4', 'rounded-lg', 'mt-4');

                switch (type) {
                    case 'loading':
                        statusMessage.classList.add('bg-blue-100', 'text-blue-700', 'font-medium');
                        break;
                    case 'success':
                        statusMessage.classList.add('bg-green-100', 'text-green-700', 'font-medium');
                        break;
                    case 'error':
                        statusMessage.classList.add('bg-red-100', 'text-red-700', 'font-medium');
                        break;
                    case 'warning':
                        statusMessage.classList.add('bg-yellow-100', 'text-yellow-700', 'font-medium');
                        break;
                }
            }
        }); // DOMContentLoaded ë
    </script>
</body>
</html>
=======
    <title>ê°ì²´ì§€í–¥ í´ë˜ìŠ¤ êµ¬ì¡° ì‹œê°í™” ë„êµ¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f7fafc; }
        .uml-card {
            min-width: 250px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s;
        }
        .uml-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
        }
        .uml-card-name {
            font-weight: 700;
            padding: 8px 12px;
            border-bottom: 2px solid #e2e8f0;
        }
        .uml-card-section {
            padding: 4px 12px;
            font-size: 0.85rem;
            border-bottom: 1px solid #edf2f7;
        }
        .uml-card-section:last-child {
            border-bottom: none;
        }
        .uml-item {
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .uml-field { color: #2c5282; } /* Blue for Fields */
        .uml-method { color: #005f6b; } /* Teal for Methods */
    </style>
</head>
<body class="p-6 md:p-10">

    <div class="max-w-7xl mx-auto">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-2">ì½”ë“œ êµ¬ì¡° ì‹œê°í™” ë„êµ¬</h1>
        <p class="text-gray-600 mb-6">Java ë˜ëŠ” C++ ì½”ë“œë¥¼ ì…ë ¥í•˜ì—¬ í´ë˜ìŠ¤/ì¸í„°í˜ì´ìŠ¤ì˜ UML-ìœ ì‚¬ ë‹¤ì´ì–´ê·¸ë¨ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>

        <!-- ì…ë ¥ ì˜ì—­ -->
        <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
            <label for="codeInput" class="block text-lg font-semibold text-gray-700 mb-3">ê°ì²´ì§€í–¥ ì½”ë“œ ì…ë ¥ (Java/C++)</label>
            <textarea id="codeInput" rows="15" class="w-full p-4 border border-gray-300 rounded-lg resize-none focus:ring-blue-500 focus:border-blue-500 text-sm font-mono" placeholder="ì—¬ê¸°ì— C++ ë˜ëŠ” Java í´ë˜ìŠ¤ ì½”ë“œë¥¼ ë¶™ì—¬ ë„£ìœ¼ì„¸ìš”.">
// Java ìƒ˜í”Œ ì½”ë“œ
public interface Payable {
    double getPaymentAmount();
}

public class Employee implements Payable {
    private String name;
    protected double baseSalary;
    public static final String COMPANY = "TechCorp";

    public Employee(String name, double baseSalary) {
        this.name = name;
        this.baseSalary = baseSalary;
    }

    public void setName(String name) {
        this.name = name;
    }

    public double getPaymentAmount() {
        return baseSalary * 1.1; // 10% bonus
    }
}
            </textarea>
            <button onclick="generateDiagram()" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-150 ease-in-out shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±
            </button>
        </div>

        <!-- ì¶œë ¥ ì˜ì—­ -->
        <h2 class="text-3xl font-bold text-gray-800 mb-4">ì‹œê°í™” ê²°ê³¼ (UML-ìœ ì‚¬ í´ë˜ìŠ¤ ì¹´ë“œ)</h2>
        <div id="diagramOutput" class="flex flex-wrap gap-8 justify-center items-start p-6 bg-gray-100 rounded-xl min-h-64">
            <p class="text-gray-500 text-center w-full mt-20" id="initialMessage">ì½”ë“œë¥¼ ì…ë ¥í•˜ê³  'ë‹¤ì´ì–´ê·¸ë¨ ìƒì„±' ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
        </div>

    </div>

    <script>
        // ì ‘ê·¼ ì œí•œì ë§¤í•‘ (UML Notation)
        const ACCESS_MAP = {
            'public': '+',
            'private': '-',
            'protected': '#',
            'static': 'S', // Static is often underlined, using 'S' for simplicity in this text-based display
            'final': 'F' // Final/Constant is also represented, 'F' for simplicity
        };

        /**
         * ì½”ë“œì—ì„œ í´ë˜ìŠ¤ ë˜ëŠ” ì¸í„°í˜ì´ìŠ¤ êµ¬ì¡°ë¥¼ íŒŒì‹±í•©ë‹ˆë‹¤.
         * ë‹¨ìˆœí™”ëœ ì •ê·œ í‘œí˜„ì‹ì„ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ì ì¸ í´ë˜ìŠ¤ëª…, í•„ë“œ, ë©”ì†Œë“œë§Œ ì¶”ì¶œí•©ë‹ˆë‹¤.
         */
        function parseCode(code) {
            const definitions = [];
            
            // 1. ì£¼ì„ ì œê±° (ë‹¨ìˆœí™”)
            code = code.replace(/\/\/.*|\/\*[\s\S]*?\*\//g, '');

            // 2. í´ë˜ìŠ¤ ë˜ëŠ” ì¸í„°í˜ì´ìŠ¤ ë¸”ë¡ ì°¾ê¸° (class/interface NAME { ... })
            // ì´ ì •ê·œì‹ì€ ë‹¨ìˆœí™”ë¥¼ ìœ„í•´ ì¤‘ê´„í˜¸ ê¹Šì´ ê³„ì‚° ì—†ì´ ì „ì²´ ë¸”ë¡ì„ ë¬¸ìì—´ë¡œ ì°¾ìŠµë‹ˆë‹¤.
            const classRegex = /(?:public|private|protected)?\s+(class|interface)\s+([a-zA-Z0-9_]+)(?:\s+extends\s+([a-zA-Z0-9_]+))?(?:\s+implements\s+([a-zA-Z0-9_, ]+))?\s*\{([\s\S]*?)\n\}/g;
            let match;

            while ((match = classRegex.exec(code)) !== null) {
                const definitionType = match[1]; // class or interface
                const name = match[2];
                const blockContent = match[5]; // Content inside the main {} block

                const definition = {
                    name: name,
                    type: definitionType.charAt(0).toUpperCase() + definitionType.slice(1), // Class or Interface
                    fields: [],
                    methods: []
                };

                // 3. í•„ë“œ (ì†ì„±) ì¶”ì¶œ (Java/C++ ìœ ì‚¬ êµ¬ë¬¸)
                // ì˜ˆ: private String name; ë˜ëŠ” int age;
                const fieldRegex = /(?:public|private|protected)?(?:\s+static)?(?:\s+final)?\s+([a-zA-Z0-9_<>\[\]]+)\s+([a-zA-Z0-9_]+)\s*(?:=|;)/g;
                let fieldMatch;
                
                // í•„ë“œ íŒŒì‹±ì„ ìœ„í•œ ê°„ë‹¨í•œ ë¡œì§: ì ‘ê·¼ ì œí•œì, íƒ€ì…, ì´ë¦„
                const lines = blockContent.split(';').map(line => line.trim()).filter(line => line.length > 0 && !line.includes('('));

                for (const line of lines) {
                    const parts = line.split(/\s+/).filter(p => p.length > 0);
                    if (parts.length >= 2) {
                        const access = parts.find(p => ['public', 'private', 'protected'].includes(p)) || '';
                        const isStatic = parts.includes('static') ? 'S' : '';
                        const isFinal = parts.includes('final') ? 'F' : '';
                        
                        // íƒ€ì…ê³¼ ì´ë¦„ ì°¾ê¸° (ê°€ì¥ ë‹¨ìˆœí•œ ì ‘ê·¼)
                        let type = parts[parts.length - 2];
                        let fieldName = parts[parts.length - 1].replace(/[^a-zA-Z0-9_]/g, ''); // ë§ˆì§€ë§‰ ë‹¨ì–´ë¥¼ ì´ë¦„ìœ¼ë¡œ ê°€ì •

                        // ìƒì„±ìë‚˜ ë©”ì†Œë“œ ì„ ì–¸ì´ ì•„ë‹Œì§€ í™•ì¸ (ê´„í˜¸ê°€ ì—†ëŠ”ì§€ í™•ì¸)
                        if (!line.includes('(') && !line.includes(')')) {
                            // UML í‘œê¸°ë²•: [ì ‘ê·¼] [ì´ë¦„]: [íƒ€ì…]
                            const symbol = ACCESS_MAP[access] || ACCESS_MAP['public']; // ê¸°ë³¸ì€ public (+)
                            const notation = `${symbol} ${fieldName}: ${type}`;
                            definition.fields.push(notation);
                        }
                    }
                }


                // 4. ë©”ì†Œë“œ (ì—°ì‚°) ì¶”ì¶œ
                // ì˜ˆ: public double getPaymentAmount() { ... }
                const methodRegex = /(?:public|private|protected)?(?:\s+static)?(?:\s+final)?\s+([a-zA-Z0-9_<>\[\]]+)\s+([a-zA-Z0-9_]+)\s*\((.*?)\)\s*(?:throws\s+[a-zA-Z0-9_]+)?\s*\{/g;
                let methodMatch;

                while ((methodMatch = methodRegex.exec(blockContent)) !== null) {
                    const fullSignature = methodMatch[0].trim().replace('{', '').trim();
                    const parts = fullSignature.split(/\s+/).filter(p => p.length > 0);

                    // ì ‘ê·¼ ì œí•œì ì¶”ì¶œ
                    const access = parts.find(p => ['public', 'private', 'protected'].includes(p)) || '';
                    const symbol = ACCESS_MAP[access] || ACCESS_MAP['public'];

                    // ë°˜í™˜ íƒ€ì…ê³¼ ë©”ì†Œë“œ ì´ë¦„ ì¶”ì¶œ (ìƒì„±ì ì œì™¸ë¥¼ ìœ„í•´ ì´ë¦„ê³¼ í´ë˜ìŠ¤ëª…ì´ ë‹¤ë¥¸ ê²½ìš°ë§Œ ì¶”ì¶œ)
                    if (methodMatch[2] !== name) {
                        // UML í‘œê¸°ë²•: [ì ‘ê·¼] [ì´ë¦„]([íŒŒë¼ë¯¸í„°]): [ë°˜í™˜ íƒ€ì…]
                        const returnType = methodMatch[1];
                        const methodName = methodMatch[2];
                        const parameters = methodMatch[3].trim().split(',').filter(p => p.length > 0).join(', '); // íŒŒë¼ë¯¸í„° ëª©ë¡ì„ ê°„ë‹¨íˆ ì •ë¦¬

                        const notation = `${symbol} ${methodName}(${parameters}): ${returnType}`;
                        definition.methods.push(notation);
                    } else if (methodMatch[2] === name && definitionType === 'class') {
                        // ìƒì„±ì (Constructors) - ë°˜í™˜ íƒ€ì… ì—†ì´ ì´ë¦„ë§Œ
                        const parameters = methodMatch[3].trim().split(',').filter(p => p.length > 0).join(', ');
                        const notation = `${symbol} ${name}(${parameters})`; // ìƒì„±ìëŠ” ë°˜í™˜ íƒ€ì… ì—†ìŒ
                        definition.methods.push(notation);
                    }
                }
                
                definitions.push(definition);
            }

            return definitions;
        }

        /**
         * íŒŒì‹±ëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ UML-ìœ ì‚¬ ì¹´ë“œ HTMLì„ ìƒì„±í•©ë‹ˆë‹¤.
         */
        function renderDiagram(definitions) {
            const output = document.getElementById('diagramOutput');
            const initialMessage = document.getElementById('initialMessage');
            output.innerHTML = '';
            
            if (definitions.length === 0) {
                output.innerHTML = '<p class="text-gray-500 text-center w-full mt-20">í´ë˜ìŠ¤ ë˜ëŠ” ì¸í„°í˜ì´ìŠ¤ ì •ì˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì½”ë“œë¥¼ í™•ì¸í•´ ì£¼ì„¸ìš”.</p>';
                return;
            }

            if (initialMessage) { initialMessage.style.display = 'none'; }
            
            definitions.forEach(def => {
                const isInterface = def.type === 'Interface';
                const cardColor = isInterface ? 'bg-yellow-50 border-yellow-300' : 'bg-white border-blue-300';
                const typeText = isInterface ? '<<Interface>>' : def.type;

                // ì¹´ë“œ HTML êµ¬ì¡°
                const cardHtml = `
                    <div class="uml-card border-2 rounded-lg ${cardColor} flex flex-col overflow-hidden">
                        <!-- Name Section -->
                        <div class="uml-card-name text-gray-900 bg-gray-100">
                            <div class="text-xs text-gray-500 font-normal">${typeText}</div>
                            ${def.name}
                        </div>
                        
                        <!-- Fields Section -->
                        <div class="uml-card-section text-gray-700">
                            <h4 class="font-bold mb-1 text-xs uppercase text-gray-500">Attributes</h4>
                            ${def.fields.map(field => `<div class="uml-item uml-field">${field}</div>`).join('') || '<div class="text-gray-400 italic">No fields defined</div>'}
                        </div>

                        <!-- Methods Section -->
                        <div class="uml-card-section text-gray-700">
                            <h4 class="font-bold mb-1 text-xs uppercase text-gray-500">Methods</h4>
                            ${def.methods.map(method => `<div class="uml-item uml-method">${method}</div>`).join('') || '<div class="text-gray-400 italic">No methods defined</div>'}
                        </div>
                    </div>
                `;
                output.innerHTML += cardHtml;
            });
        }

        /**
         * ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜
         */
        function generateDiagram() {
            const code = document.getElementById('codeInput').value;
            try {
                const definitions = parseCode(code);
                renderDiagram(definitions);
            } catch (error) {
                console.error("ë‹¤ì´ì–´ê·¸ë¨ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                const output = document.getElementById('diagramOutput');
                output.innerHTML = `<p class="text-red-500 text-center w-full mt-20">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}. ì…ë ¥ëœ ì½”ë“œê°€ ìœ íš¨í•œì§€ í™•ì¸í•´ ì£¼ì„¸ìš”.</p>`;
            }
        }
        
        // ì´ˆê¸° ë¡œë“œ ì‹œ ìƒ˜í”Œ ì½”ë“œë¡œ í•œë²ˆ ì‹¤í–‰
        window.onload = function() {
            generateDiagram();
        };

    </script>
</body>
</html>
>>>>>>> cb54faa3e984b57bd251c0e53d8dc09665bcf1a0
